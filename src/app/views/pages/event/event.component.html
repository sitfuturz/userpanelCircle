<div class="event-container">
  <!-- Header Section -->
  <div class="event-header">
    <h1 class="page-title">Events</h1>
    <div class="header-controls">
      <div class="tab-container">
        <button 
          class="tab-btn" 
          [class.active]="activeTab === 'upcoming'"
          (click)="switchTab('upcoming')">
          Upcoming Events
        </button>
        <button 
          class="tab-btn" 
          [class.active]="activeTab === 'recent'"
          (click)="switchTab('recent')">
          Recent Events
        </button>
      </div>
    </div>
  </div>

  <!-- Events Container -->
  <div class="events-container">
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="spinner"></div>
      <p>Loading events...</p>
    </div>

    <!-- Events List -->
    <div *ngIf="!isLoading" class="events-list">
      <div 
        *ngFor="let event of currentEvents; trackBy: trackByEventId" 
        class="event-card"
        (click)="openDetailModal(event)">
        
        <!-- Event Image -->
        <div class="event-image">
          <img 
            [src]="getEventImage(event)"
            [alt]="event.name"
            class="event-thumbnail"
            onerror="this.src='assets/images/placeholder-image.png'">
          
          <!-- Event Badge -->
         <!-- <div class="event-badge" [class]="event.event_or_meeting">
  {{ formatEventType(event.event_or_meeting ?? 'unknown') }}
</div> -->
          
          <!-- Paid Badge -->
          <div *ngIf="event.paid" class="paid-badge">
            â‚¹{{ event.amount }}
          </div>
        </div>

        <!-- Event Info -->
        <div class="event-info">
          <h3 class="event-name">{{ event.name }}</h3>
          
          <div class="event-meta">
            <div class="meta-item">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                <line x1="16" y1="2" x2="16" y2="6"/>
                <line x1="8" y1="2" x2="8" y2="6"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
              </svg>
              <span>{{ formatDate(event.date) }}</span>
            </div>
            
            <div class="meta-item" *ngIf="event.startTime">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12,6 12,12 16,14"/>
              </svg>
              <span>{{ formatTime(event.startTime) }}</span>
            </div>
            
            <div class="meta-item" *ngIf="event.location">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                <circle cx="12" cy="10" r="3"/>
              </svg>
              <span>{{ event.location }}</span>
            </div>
            
            <div class="meta-item mode-badge" [class]="event.mode">
            <div class="event-badge" [class]="event.event_or_meeting">
  {{ formatEventType(event.event_or_meeting ?? 'unknown') }}
</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="currentEvents.length === 0" class="empty-state">
        <div class="empty-icon">ðŸ“…</div>
        <h3>No {{ activeTab }} events found</h3>
        <p *ngIf="activeTab === 'upcoming'">There are no upcoming events at the moment.</p>
        <p *ngIf="activeTab === 'recent'">No recent events to display.</p>
      </div>
    </div>
  </div>
</div>

<!-- Event Detail Modal -->
<div *ngIf="showDetailModal" class="modal-overlay" (click)="closeDetailModal()">
  <div class="modal-container detail-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-title-section">
        <h2>{{ selectedEvent?.name }}</h2>
        <div class="modal-meta">
          <span class="event-type-label">{{ formatEventType(selectedEvent?.event_or_meeting || '') }}</span>
          <span class="date-label">{{ formatDate(selectedEvent?.date || '') }}</span>
        </div>
      </div>
      <button class="close-btn" (click)="closeDetailModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    
    <div class="modal-body">
      <!-- Event Image -->
      <div class="event-detail-image" *ngIf="selectedEvent?.thumbnail">
        <img [src]="selectedEvent && getEventImage(selectedEvent)" [alt]="selectedEvent?.name" class="detail-thumbnail">
      </div>

      <!-- Event Details -->
      <div class="event-details-section">
        <!-- Date and Time -->
        <div class="detail-item">
          <span class="detail-label">Date & Time</span>
          <div class="detail-value">
            <span>{{ formatDate(selectedEvent?.date || '') }}</span>
        <span *ngIf="selectedEvent?.startTime && selectedEvent?.endTime" class="time-range">
  {{ formatTime(selectedEvent?.startTime ?? '') }} - {{ formatTime(selectedEvent?.endTime ?? '') }}
</span>
          </div>
        </div>
        
        <!-- Location -->
        <div class="detail-item" *ngIf="selectedEvent?.location">
          <span class="detail-label">Location</span>
          <span class="detail-value">{{ selectedEvent?.location }}</span>
        </div>
        
        <!-- Mode -->
        <div class="detail-item">
          <span class="detail-label">Mode</span>
          <span class="detail-value mode-value" [class]="selectedEvent?.mode || 'offline'">
            {{ formatMode(selectedEvent?.mode || 'offline') }}
          </span>
        </div>
        
        <!-- Amount -->
        <div class="detail-item" *ngIf="selectedEvent?.paid">
          <span class="detail-label">Amount</span>
          <span class="detail-value amount-value">â‚¹{{ selectedEvent?.amount }}</span>
        </div>
        
        <!-- Description -->
        <div class="detail-item" *ngIf="selectedEvent?.details">
          <span class="detail-label">Description</span>
          <span class="detail-value description">{{ selectedEvent?.details }}</span>
        </div>
        
        <!-- Map URL -->
        <div class="detail-item" *ngIf="selectedEvent?.mapURL">
          <span class="detail-label">Location Map</span>
          <a [href]="selectedEvent?.mapURL" target="_blank" class="map-link">
            View on Map
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M7 17L17 7M17 7H7M17 7V17"/>
            </svg>
          </a>
        </div>
      </div>

      <!-- Gallery Section (Only for recent events) -->
      <div *ngIf="activeTab === 'recent' && selectedEventGallery && hasGalleryContent()" class="gallery-section">
        <span class="section-label">Event Gallery</span>
        
        <!-- Photos -->
        <div *ngIf="selectedEventGallery.media.photos.length > 0" class="media-subsection">
          <h4 class="media-title">Photos</h4>
          <div class="media-grid">
            <div 
              *ngFor="let photo of selectedEventGallery.media.photos.slice(0, 6); let i = index; trackBy: trackByMediaIndex"
              class="media-item"
              (click)="openMediaModal('photos', i)">
              <img 
                [src]="getGalleryImage(photo)"
                [alt]="'Event photo ' + (i + 1)"
                class="media-thumbnail">
              <div *ngIf="i === 5 && selectedEventGallery.media.photos.length > 6" class="media-overlay">
                +{{ selectedEventGallery.media.photos.length - 6 }}
              </div>
            </div>
          </div>
        </div>
        
        <!-- Videos -->
        <div *ngIf="selectedEventGallery.media.videos.length > 0" class="media-subsection">
          <h4 class="media-title">Videos</h4>
          <div class="media-grid">
            <div 
              *ngFor="let video of selectedEventGallery.media.videos.slice(0, 6); let i = index; trackBy: trackByMediaIndex"
              class="media-item video-item"
              (click)="openMediaModal('videos', i)">
              <video 
                [src]="getGalleryImage(video)"
                class="media-thumbnail"
                preload="metadata">
              </video>
              <div class="video-play-overlay">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="5,3 19,12 5,21"/>
                </svg>
              </div>
              <div *ngIf="i === 5 && selectedEventGallery.media.videos.length > 6" class="media-overlay">
                +{{ selectedEventGallery.media.videos.length - 6 }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Media Modal -->
<div *ngIf="showMediaModal" class="modal-overlay media-modal-overlay" (click)="closeMediaModal()">
  <div class="media-modal-container" (click)="$event.stopPropagation()">
    <button class="media-close-btn" (click)="closeMediaModal()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"/>
        <line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </button>
    
    <!-- Navigation buttons -->
    <button class="media-nav-btn prev-btn" (click)="previousMedia()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="15,18 9,12 15,6"/>
      </svg>
    </button>
    
    <button class="media-nav-btn next-btn" (click)="nextMedia()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="9,18 15,12 9,6"/>
      </svg>
    </button>
    
    <!-- Media content -->
    <div class="media-content">
      <img 
        *ngIf="selectedMediaType === 'photos'"
        [src]="getCurrentMediaUrl()"
        [alt]="'Event photo ' + (selectedMediaIndex + 1)"
        class="media-fullsize">
      
      <video 
        *ngIf="selectedMediaType === 'videos'"
        [src]="getCurrentMediaUrl()"
        class="media-fullsize"
        controls
        autoplay>
      </video>
    </div>
    
    <!-- Media counter -->
    <div class="media-counter">
      {{ selectedMediaIndex + 1 }} / {{ selectedMediaType === 'photos' ? selectedEventGallery?.media?.photos?.length : selectedEventGallery?.media?.videos?.length }}
    </div>
  </div>
</div>